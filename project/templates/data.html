{% extends "layout.html" %}

{% block title %}
    Search
{% endblock %}

{% block styles %}
<link href="/static/types.css" rel="stylesheet">
{% endblock %}

{% block main %}
    <a id="id" class="hidden">{{ id }}</a>
    <p id="box"></p>
    <div id="Background"></div>
    <script>
        id = document.querySelector("#id").innerHTML;
        function getData(id) {
            fetch('https://pokeapi.co/api/v2/pokemon/' + id)
            .then(resp => resp.json())
            .then(data => {
                box = document.querySelector("#box");
                console.log(data);
                moves = data.moves;
                console.log(moves);
                box.innerHTML += `${data.name}<br>`;
                moves.forEach((move) => {
                    moveName = move.move.name;
                    levelUp = {};
                    egg = {};
                    machine = {};
                    for (i of move.version_group_details) {
                        if (i.move_learn_method.name == "level-up") {
                            levelUp[moveName] = i;
                        } else if (i.move_learn_method.name == "egg") {
                            egg[moveName] = i;
                        } else {
                            machine[moveName] = i;
                        }
                    }
                    console.log(levelUp);
                    console.log(egg);
                    console.log(machine);
                    box.innerHTML += `${moveName}. Learnt at Level ${move.version_group_details[0].level_learned_at}.<br>`;
                })
            })
        }
        getData(id);
    </script>
{% endblock %}